{% load l10n xml_node %}
<ZKN:zakLk01
        xmlns:StUF="http://www.egem.nl/StUF/StUF0301"
        xmlns:ZKN="http://www.egem.nl/StUF/sector/zkn/0310"
        xmlns:BG="http://www.egem.nl/StUF/sector/bg/0310"
        xmlns:GML="http://www.opengis.net/gml"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xsi:schemaLocation="http://www.stufstandaarden.nl/koppelvlak/zds0120 ../zds0120_msg_zs-dms.xsd">
    <ZKN:stuurgegevens>
        <StUF:berichtcode>Lk01</StUF:berichtcode>
        {% include "stuf_zds/soap/includes/stuurgegevens.xml" %}
        <StUF:entiteittype>ZAK</StUF:entiteittype>
    </ZKN:stuurgegevens>
    <ZKN:parameters>
        <StUF:mutatiesoort>T</StUF:mutatiesoort>
        <StUF:indicatorOvername>V</StUF:indicatorOvername>
    </ZKN:parameters>
    <ZKN:object StUF:verwerkingssoort="T" StUF:entiteittype="ZAK">
        <ZKN:identificatie>{{ zaak_identificatie }}</ZKN:identificatie>
        <ZKN:omschrijving>{{ zaak_omschrijving }}</ZKN:omschrijving>
        {% for kenmerk in kenmerken %}
        <ZKN:kenmerk>
            <ZKN:kenmerk>{{ kenmerk }}</ZKN:kenmerk>
            <ZKN:bron>Open Formulieren</ZKN:bron>
        </ZKN:kenmerk>
        {% endfor %}
        {% if locatie %}
        <ZKN:anderZaakObject>
               <ZKN:omschrijving>{{ locatie.key }}</ZKN:omschrijving>
               <ZKN:lokatie>
                    <GML:Point srsName="http://www.opengis.net/def/crs/EPSG/0/4326">
                        <GML:pos>{{ locatie.coordinaat.lat|unlocalize }} {{ locatie.coordinaat.lng|unlocalize }}</GML:pos>
                    </GML:Point>
               </ZKN:lokatie>
        </ZKN:anderZaakObject>
        {% endif %}
        <ZKN:startdatum>{{ datum_vandaag }}</ZKN:startdatum>
        <ZKN:registratiedatum>{{ datum_vandaag }}</ZKN:registratiedatum>
        {% optional_node "ZKN:betalingsIndicatie" betalings_indicatie %}
        {% optional_node "ZKN:laatsteBetaaldatum" laatste_betaaldatum %}
        <ZKN:zaakniveau>1</ZKN:zaakniveau>
        <ZKN:deelzakenIndicatie>N</ZKN:deelzakenIndicatie>
        <StUF:tijdstipRegistratie>{{ tijdstip_registratie }}</StUF:tijdstipRegistratie>
        {% include "stuf_zds/soap/includes/extraElementen.xml" %}
        <ZKN:isVan StUF:entiteittype="ZAKZKT" StUF:verwerkingssoort="T">
            <ZKN:gerelateerde StUF:verwerkingssoort="I" StUF:entiteittype="ZKT">
                <ZKN:omschrijving>{{ zds_zaaktype_omschrijving }}</ZKN:omschrijving>
                <ZKN:code>{{ zds_zaaktype_code }}</ZKN:code>
                <ZKN:ingangsdatumObject>{{ datum_vandaag }}</ZKN:ingangsdatumObject>
            </ZKN:gerelateerde>
        </ZKN:isVan>
        {% if initiator.bsn or initiator.kvk %}
            <ZKN:heeftAlsInitiator StUF:verwerkingssoort="T" StUF:entiteittype="ZAKBTRINI">
                <ZKN:gerelateerde>
                    {% if initiator.bsn %}
                        <ZKN:natuurlijkPersoon StUF:entiteittype="NPS" StUF:verwerkingssoort="T">
                            {% optional_node "BG:inp.bsn" initiator.bsn %}
                            <BG:authentiek StUF:metagegeven="true">J</BG:authentiek>
                            {% optional_node "BG:geslachtsnaam" initiator.geslachtsnaam %}
                            {% optional_node "BG:voorvoegselGeslachtsnaam" initiator.tussenvoegsel %}
                            {% optional_node "BG:voorletters" initiator.voorletters %}
                            {% optional_node "BG:voornamen" initiator.voornamen %}
{#                            <BG:geslachtsaanduiding>?</BG:geslachtsaanduiding>#}
                            {% optional_node "BG:geboortedatum" initiator.geboortedatum %}

                            {% if initiator.adres %}
                            <BG:verblijfsadres>
                                <BG:authentiek>J</BG:authentiek>
                                {% optional_node "BG:wpl.woonplaatsNaam" initiator.adres.plaats %}
                                {% optional_node "BG:gor.straatnaam" initiator.adres.straat %}
                                {% optional_node "BG:aoa.postcode" initiator.adres.postcode %}
                                {% optional_node "BG:aoa.huisnummer" initiator.adres.huisnummer %}
                                {% optional_node "BG:aoa.huisletter" initiator.adres.huisletter %}
                                {% optional_node "BG:aoa.huisnummertoevoeging" initiator.adres.huisnummer_toevoeging %}
                             </BG:verblijfsadres>
                            {% endif %}
                        </ZKN:natuurlijkPersoon>
                    {% elif initiator.kvk %}
                        <ZKN:vestiging StUF:entiteittype="VES" StUF:verwerkingssoort="T">
                            <BG:vestigingsNummer>{{ initiator.kvk }}</BG:vestigingsNummer>
                            <BG:authentiek StUF:metagegeven="true">J</BG:authentiek>
                        </ZKN:vestiging>
                    {% endif %}
                </ZKN:gerelateerde>
                <StUF:tijdstipRegistratie>{{ tijdstip_registratie }}</StUF:tijdstipRegistratie>
            </ZKN:heeftAlsInitiator>
        {% elif not global_config.allow_empty_initiator %}
            <ZKN:heeftAlsInitiator StUF:verwerkingssoort="T" StUF:entiteittype="ZAKBTRINI">
                <ZKN:gerelateerde>
                    <ZKN:natuurlijkPersoon StUF:entiteittype="NPS" StUF:verwerkingssoort="T">
                        <BG:inp.bsn>111222333</BG:inp.bsn>
                        <BG:authentiek StUF:metagegeven="true">N</BG:authentiek>
                    </ZKN:natuurlijkPersoon>
                </ZKN:gerelateerde>
                <StUF:tijdstipRegistratie>{{ tijdstip_registratie }}</StUF:tijdstipRegistratie>
            </ZKN:heeftAlsInitiator>
        {% endif %}
        <ZKN:heeft StUF:entiteittype="ZAKSTT" StUF:verwerkingssoort="T">
            <ZKN:gerelateerde StUF:entiteittype="STT" StUF:verwerkingssoort="I">
                <ZKN:code>{{ zds_zaaktype_status_code }}</ZKN:code>
                <ZKN:omschrijving>{{ zds_zaaktype_status_omschrijving }}</ZKN:omschrijving>
            </ZKN:gerelateerde>
            <ZKN:toelichting>Status gezet door verzendende applicatie.</ZKN:toelichting>
            <ZKN:datumStatusGezet>{{ datum_vandaag }}</ZKN:datumStatusGezet>
        </ZKN:heeft>
    </ZKN:object>
</ZKN:zakLk01>
